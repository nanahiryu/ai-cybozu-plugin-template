# 開発ワークフロー: The /plan Process

Cursor / Claude Code 上で `/plan` コマンド（またはそれに準ずる指示）を実行することで開始される、標準的な開発フローです。

## Phase 1: Planning (設計フェーズ)

AI エージェントと共に、漠然としたアイデアを具体的な仕様へと落とし込みます。

### 1. kintone アプリ構成の取得

- 対象となる kintone アプリのフィールド情報、設定情報を取得し、コンテキストとして読み込みます。
- アプリが存在しない場合は、スキップ。

### 2. ユースケースのヒアリング

ユーザーとの対話を通じて、要件を明確化します。

- **ユーザーは誰か**: 利用者の役割、部門など。
- **やりたいことは何か**: 解決したい課題、実現したい機能。
- 複数のユースケースがある場合はすべて洗い出します。

### 3. データ設計

ヒアリング結果を元に、データの構成を設計します。

- **プラグイン設定**: ユーザーが設定画面で何を入力する必要があるか。
- **kintone アプリ設計**: プラグイン動作のために新しいフィールドや別アプリが必要か。

アプリが作成されていない場合はこのステップでアプリを作成しましょう

1. `scritps/kintone-app/{kintoneアプリを表す英名}.json`にフィールド情報を作成
   - https://cybozu.dev/ja/kintone/docs/rest-api/apps/form/add-form-fields/のpropertiesを参考に作成
2. 以下コマンドで kintone 環境にアプリを作成

```bash
pnpm create-kintone-app "{アプリ名}" "{scripts/kintone-app/のjsonファイル名(拡張子なし)}"
```

### 4. Handler 設計

- kintone のどのイベントをフックするか
- ハンドラでどのような処理を行うか

決定します。

- 例: `app.record.create.submit` (レコード追加保存前)
- 例: `app.record.index.show` (一覧画面表示時)

### 5. UI 設計

画面上の変更内容を定義します。

- ボタンの配置、ダイアログの表示、フィールドの制御（表示/非表示/無効化）など。

---

## Phase 2: Development (実装フェーズ)

設計に基づき、テストファーストで堅実に実装を進めます。

### 6. テスト設計・実装

実装前にテスト仕様を策定します。

1. **E2E テスト (Playwright)**: ユーザー操作全体のフロー確認。
2. **Integration テスト**: 各イベントハンドラの動作確認。
3. **Unit テスト**: ビジネスロジック、ユーティリティ関数、UI コンポーネントの単体テスト。

### 7. 実装計画の構築 (GitHub Issue)

作業を小さなタスクに分割し、GitHub Issue を作成します。
各 Issue には明確な完了条件（Acceptance Criteria）を設定します。

### 8. Issue Driven 開発

Issue 単位で開発を進めます。

- ブランチ作成 → 実装 → テスト実行 → コミット → PR 作成。
- AI は Issue の内容とテストコードを正解として実装を行います。

### 9. テスト実行 & 検証

すべてのテストがパスすることを確認し、完了とします。
